---
export const prerender = true

import { getCollection } from 'astro:content'
import Layout, { type SEOProps } from '~/layouts/Layout.astro'
import { createWebPageSchema } from '~/utils/schema'

const posts = (await getCollection('blog'))
  .filter((post) => post.data.published !== false)
  .sort((a, b) => {
    const dateA = (a.data.pubDate || new Date(0)).valueOf()
    const dateB = (b.data.pubDate || new Date(0)).valueOf()
    return dateB - dateA
  })

const seo: SEOProps = {
  title: 'iGaming Marketing Blog and Growth Insights | MediaPath',
  description:
    'Read MediaPath EU blog insights on iGaming marketing, user acquisition, affiliate growth, and paid media strategy for sustainable performance.',
  canonical: `${Astro.site}blog/`,
  keywords: 'igaming blog, growth insights, affiliate strategy, media buying',
  image: `${Astro.site}images/mediapath-og.webp`,
  ldJSON: createWebPageSchema({
    name: 'MediaPath EU Blog',
    url: `${Astro.site}blog/`,
    description: 'Insights on iGaming marketing, user acquisition, affiliate growth, and paid media strategy.',
    image: `${Astro.site}images/mediapath-og.webp`,
  }),
}
---

<Layout seo={seo}>
  <section class="mx-auto max-w-4xl px-4 py-16">
    <h1 class="text-4xl font-black tracking-tight text-slate-900">iGaming Growth Blog</h1>
    <p class="mt-3 text-lg text-slate-700">Add long-form posts to `src/content/blog/` to publish your marketing insights.</p>
    <p class="mt-3 text-slate-700">
      Use this section to publish analysis of acquisition trends, paid media learnings, affiliate channel updates, and practical frameworks for conversion growth.
    </p>

    {
      posts.length === 0 ? (
        <div class="mt-10 rounded-xl border border-dashed border-slate-300 bg-white p-8">
          <h2 class="text-xl font-bold text-slate-900">No blog posts yet</h2>
          <p class="mt-2 text-sm text-slate-600">Create your first markdown file in `src/content/blog/` and it will appear here automatically.</p>
        </div>
      ) : (
        <ul class="mt-10 space-y-4">
          {posts.map((post) => (
            <li class="rounded-xl border border-slate-200 bg-white p-6">
              <a href={`/blog/${post.slug}/`} class="text-xl font-bold text-slate-900 hover:underline">{post.data.title}</a>
              <p class="mt-2 text-sm text-slate-600">{post.data.description}</p>
            </li>
          ))}
        </ul>
      )
    }
  </section>
</Layout>
